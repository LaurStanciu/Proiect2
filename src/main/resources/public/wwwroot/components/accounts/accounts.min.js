!function(){"use strict";function t(t,n,e,o,a,i,r,s,c,u){i.accounts=n,i.data=e,i.accountExists=!1,i.incorrectCredentials=!1,i.vm={signIn:{},signUp:{}},i.events={signIn:function(){i.events.signOut(),i.progressbar&&i.progressbar.complete(),i.progressbar=c.createInstance(),i.progressbar.start(),a.post("/api/accounts/sign-in",i.vm.signIn).then(function(n){1==n.data.type&&(i.progressbar.complete(),t.loginDetails.email=i.vm.signIn.email,t.loginDetails.logged=!0,r.go("search"),i.createToasts.toastSuccess()),3==n.data.type&&(i.progressbar.complete(),i.incorrectCredentials=!0,i.createToasts.toastFailed())},function(t){return i.progressbar.complete(),i.createToasts.toastFailed(),t})},signUp:function(){i.accountExists=!1,i.progressbar&&i.progressbar.complete(),i.progressbar=c.createInstance(),i.progressbar.start(),a.post("/api/accounts/sign-up",i.vm.signUp).then(function(t){1==t.data.type&&(i.progressbar.complete(),r.go("accounts.sign-in"),i.createToasts.toastSuccess()),3==t.data.type&&(i.progressbar.complete(),i.accountExists=!0,i.createToasts.toastFailed())},function(t){return i.progressbar.complete(),i.createToasts.toastFailed(),t})},signOut:function(){t.loginDetails.email="",t.loginDetails.logged=!1,r.go("accounts.sign-in")}},i.createToasts={toastSuccess:function(){u.create({className:" bg-success text-white",content:"<p>Success!</p>",timeout:1500})},toastWarning:function(t){var n=t;""!==t&&null!==t||(n="Warning");var e="<p>"+n+"</p>";u.create({className:" bg-warning text-white",content:e,timeout:1500})},toastFailed:function(){u.create({className:" bg-danger text-white",content:"<p>Failed!</p>",timeout:1500})}}}angular.module("app").controller("accountsCtrl",t),t.$inject=["$rootScope","accounts","data","$location","$http","$scope","$state","$stateParams","ngProgressBar","ngToast"]}(),function(){"use strict";function t(t,n,e,o,a){var i={identity:{},contents:null},r={identity:function(){var t=e.location.newURL(!0,{api:"api",controller:"accounts",action:"identity"});return n.post(t).then(function(t){return t},function(t){return t})},signOut:function(){t.loginDetails.email="",t.loginDetails.logged=!1,a.go("accounts.sign-in")},signUp:function(t){var o=e.location.newURL(!0,{api:"api",controller:"accounts",action:"sign-Up"});return n.post(o,t).then(function(t){return t},function(t){return t})},signIn:function(t){var o=e.location.newURL(!0,{api:"api",controller:"accounts",action:"sign-in"});return n.post(o,t).then(function(t){return t},function(t){return t})},getContents:function(t,o){var a=$.extend({},{id:0},t),i=$.extend({},{role:null,country:null,language:null},o),r=e.location.newURL(!0,{api:"api",controller:"accounts",id:a.id,segments:["contents"]},i);return n.get(r).then(function(t){return t},function(t){return t})},updateContents:function(t,o,a){var i=$.extend({},{id:0},t),r=$.extend({},{role:null,country:null,language:null},o),s=e.location.newURL(!0,{api:"api",controller:"accounts",id:i.id,segments:["contents"]},r);return n.post(s,a).then(function(t){return t},function(t){return t})}},s={};return s.identity=function(){return t.loginDetails.email},s.loadIdentity=function(){return r.identity().then(function(t){return 200==t.status&&(i.identity=$.extend(!0,{},t.data)),t})},s.isAuthenticated=function(){return t.loginDetails.logged},s.signIn=function(t){return r.signOut().then(function(n){return i.identity={},r.signIn(t)}).then(function(t){return t})},s.signUp=function(t){return r.signOut().then(function(n){return r.signUp(t)}).then(function(t){return t})},s.signOut=function(){t.loginDetails.email="",t.loginDetails.logged=!1,a.go("accounts.sign-in")},s.sref=function(t){var n=$.extend(!0,{},{state:"sign-in"},t),e=o.search().returnState,i=o.search().returnStateParams;e=e?e:encodeURIComponent(a.current.name),i=i?i:encodeURIComponent(JSON.stringify(a.params)),a.go(n.state,{returnState:e,returnStateParams:i},{reload:!0,notify:!0})},s.getContents=function(){return t.loginDetails.email},s.updateContents=function(t,n,e){return r.updateContents(t,n,e).then(function(t){return t})},s.load=function(t){if(t||null==i.identity.Id)return s.loadIdentity()},s}angular.module("app").factory("accounts",t),t.$inject=["$rootScope","$http","data","$location","$state"]}();